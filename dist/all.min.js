!function(e,n){"object"==typeof exports&&"object"==typeof module?module.exports=n(require("lodash"),require("objectpath")):"function"==typeof define&&define.amd?define("cn-flex-form",["lodash","objectpath"],n):"object"==typeof exports?exports["cn-flex-form"]=n(require("lodash"),require("objectpath")):e["cn-flex-form"]=n(e.lodash,e.objectpath)}(this,function(e,n){return function(e){function n(r){if(t[r])return t[r].exports;var o=t[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}var t={};return n.m=e,n.c=t,n.p="",n(0)}([function(e,n,t){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var o=t(1),a=r(o),s=t(2),i=r(s),c=t(3),l=t(4),d=t(5),f=r(d),m=t(8),u=r(m),p=t(9),h=t(10),g=r(h),v=t(12),y=r(v),b=t(13),x=r(b);console.log(f.default),n.default=angular.module("cn.flex-form",["ui.router","schemaForm","ui.bootstrap.datetimepicker","cnTagsInput","cn.util"]).provider("cnFlexFormConfig",a.default).provider("cnFlexFormTypes",i.default).provider("cnFlexFormRoutes",c.cnFlexFormRoutesProvider).config(c.cnFlexFormRoutes).config(l.schemaFormConfig).run(l.addTemplates).provider("cnFlexFormService",f.default).provider("cnFlexFormModalLoaderService",u.default).factory("FlexFormModal",p.FlexFormModal).controller("FlexFormModalLoader",p.FlexFormModalLoader).directive("cnFlexForm",g.default).directive("cnFlexFormHeader",y.default).directive("ffValidate",x.default).name},function(e,n){"use strict";function t(){function e(e){t.push(e)}function n(e){"ngInject";function n(){return _.chain(e).omit(t).omit(function(e){return _.isUndefined(e)||_.isNull(e)}).value()}return{getStateParams:n,ignoreParams:t}}n.$inject=["$stateParams"];var t=["page","debug","sandbox","modal","modalId"];return{addIgnoreParam:e,$get:n}}Object.defineProperty(n,"__esModule",{value:!0}),n.default=t},function(e,n){"use strict";function t(){function e(e){t.unshift(e)}function n(){function e(e){for(var n=0,r=t.length;n<r;n++)if(t[n].condition(e))return t[n].type;return e.type||e.schema&&e.schema.type}return{fieldTypeRegister:t,getFieldType:e}}var t=[{condition:function(e){return"hidden"===e.type},type:"hidden"},{condition:function(e){return e.type.includes("radios")},type:"cn-radios"},{condition:function(e){return e.type.includes("radiobuttons")},type:"cn-radiobuttons"},{condition:function(e){return e.type.includes("autocomplete")||e.titleMap||e.titleMapResolve||e.titleMapQuery},type:"cn-autocomplete"},{condition:function(e){return"cn-datetimepicker"===e.type||"datetime-local"===e.type||"time-minutes"===e.type},type:"cn-datetimepicker"},{condition:function(e){return"help"===e.type},type:"help"},{condition:function(e){return e.type.includes("display")},type:"cn-display"},{condition:function(e){return e.schema&&e.schema.format&&e.schema.format.includes("currency")},type:"cn-currency"},{condition:function(e){return e.schema&&"percentage"===e.schema.format},type:"cn-percentage"},{condition:function(e){return"toggle"===e.type||"boolean"===e.type},type:"cn-toggle"},{condition:function(e){return"mediaupload"===e.type},type:"cn-mediaupload"},{condition:function(e){return"csvupload"===e.type},type:"cn-csvupload"},{condition:function(e){return"reusable"===e.type},type:"cn-reusable"},{condition:function(e){return"table"===e.type},type:"cn-table"},{condition:function(e){return"array"===e.type},type:"array"}];return{registerFieldType:e,$get:n}}Object.defineProperty(n,"__esModule",{value:!0}),n.default=t},function(e,n){"use strict";function t(e){"ngInject";function n(){}function t(n){var t=n.permissions,r=n.name,a={controller:"FlexFormModalLoader",controllerAs:"vm",permissions:t};e.state(r+".page.modal",o({url:"/~:modal/:modalId"},a)).state(r+".page.modalParams",o({url:"/~:modal/:modalId/:restParams"},a))}return{addStates:t,$get:n}}function r(e){"ngInject";e.state("flex-form-sandbox",{url:"/flex-form/sandbox",controller:"FlexFormSandbox",controllerAs:"vm",templateUrl:"app/components/cn-flex-form/sandbox.html"})}t.$inject=["$stateProvider"],r.$inject=["$stateProvider"],Object.defineProperty(n,"__esModule",{value:!0});var o=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e};n.cnFlexFormRoutes=r,n.cnFlexFormRoutesProvider=t},function(e,n){"use strict";function t(e){"ngInject";tv4.addFormat({url:function(e){return _.isString(e)&&!/^(https?:\/\/.{2}|$)/.test(e)&&"invalid url"}});var n=["cn-fieldset","cn-toggle","cn-datetimepicker","cn-autocomplete","cn-autocomplete-detailed","cn-currency","cn-radios","cn-radiobuttons","cn-percentage","cn-display","cn-mediaupload","cn-csvupload","cn-reusable","cn-table"];_.each(n,function(n){e.registerField({type:n,templateUrl:"app/components/cn-flex-form/forms/"+n+".html"})})}function r(e){"ngInject";e.put("app/components/cn-flex-form/forms/cn-toggle.html",'\n      <div class="form-group {{form.htmlClass}}"\n           ng-class="{\'has-error\': hasError(), \'has-success\': hasSuccess()}">\n        <label class="control-label" ng-show="showTitle()">{{form.title}}</label>\n        <div class="clearfix">\n          <cn-toggle-switch\n            class="pull-left"\n            ng-show="form.key"\n            ng-model-options="form.ngModelOptions"\n            ng-model="$$value$$"\n            sf-changed="form"\n            schema-validate="form"\n            on-value="form.onValue"\n            off-value="form.offValue"\n            read-only="form.readonly"\n            undefined-class="form.undefinedClass"/>\n          <span ng-show="form.onText && form.offText">\n            {{$$value$$ === form.onValue ? form.onText : form.offText}}\n          </span>\n        </div>\n        <span class="help-block" sf-message="form.description"></span>\n      </div>'),e.put("app/components/cn-flex-form/forms/cn-datetimepicker.html",'\n      <div class="form-group {{form.htmlClass}}"\n           ng-class="{\'has-error\': hasError(), \'has-success\': hasSuccess()}">\n        <label class="control-label"\n               for="{{form.key.join(\'.\')}}"\n               ng-show="showTitle()">{{form.title}}</label>\n        <cn-datetimepicker\n          ng-show="form.key"\n          ng-model="$$value$$"\n          ng-model-options="form.ngModelOptions"\n          is-disabled="form.readonly"\n          sf-changed="form"\n          schema-validate="form"\n          input-id="{{form.key.join(\'.\')}}"\n          min-date="form.minDate"\n          max-date="form.maxDate"\n          max-view="{{form.maxView}}"\n          cn-date-required="form.required"\n          placeholder="{{form.placeholder}}"\n          model-type="{{form.schema.type}}"\n          model-formatter="form.modelFormatter"\n          model-parser="form.modelParser"\n          view-formatter="form.viewFormatter"\n          view-parser="form.viewParser"\n          format-string={{form.dateFormat}}\n          icon-class={{form.iconClass}}>\n        </cn-datetimepicker>\n        <span class="help-block" sf-message="form.description"></span>\n      </div>');var n='\n        <tags-input\n          ng-show="form.key"\n          ng-model="$$value$$"\n          ng-model-options="form.ngModelOptions"\n          ng-disabled="form.readonly"\n          sf-changed="form"\n          schema-validate="form"\n          input-id="{{form.key.join(\'.\')}}"\n          display-property="{{form.displayProperty || \'name\'}}"\n          value-property="{{form.valueProperty}}"\n          placeholder="{{form.placeholder || \' \'}}"\n          clear-on-blur="true"\n          add-on-comma="false"\n          add-from-autocomplete-only="{{!form.allowNew}}"\n          on-before-tag-added="form.onAdd({value: $tag}, form, $event, $prev)"\n          on-init="form.onInit($tag, form, $event, $setter)"\n          model-type="{{form.getSchemaType()}}"\n          array-value-type="{{form.schema.items.type}}"\n          hide-tags="{{form.detailedList}}"\n          tags-style="{{form.selectionStyle}}"\n          required="{{form.required}}"\n          min-length="{{form.minLength}}"\n          allowed-tags-pattern=".*"\n          dropdown-icon="true"\n          item-formatter="form.itemFormatter"\n          min-tags="{{form.schema.minItems}}"\n          max-tags="{{form.schema.maxItems || form.getSchemaType() !== \'array\' ? 1 : 0}}"\n          allow-bulk="{{form.bulkAdd}}"\n          bulk-delimiter="{{form.bulkDelimiter}}"\n          bulk-placeholder="{{form.bulkPlaceholder}}"\n          show-clear-all="{{form.showClearAll}}"\n          show-button="true">\n          <auto-complete\n            source="form.getTitleMap && form.getTitleMap() || form.titleQuery($query)"\n            skip-filtering="{{form.titleQuery ? true : false}}"\n            min-length="{{form.minLookup || (form.titleQuery && 3 || 0)}}">\n          </auto-complete>\n        </tags-input>';e.put("app/components/cn-flex-form/forms/cn-autocomplete.html",'\n      <div class="form-group {{form.htmlClass}}"\n           ng-class="{\'has-error\': hasError(), \'has-success\': hasSuccess()}">\n        <label class="control-label"\n               for="{{form.key.join(\'.\')}}-input"\n               ng-show="showTitle()">{{form.title}}</label>\n        '+n+'\n        <span class="help-block" sf-message="form.description"></span>\n      </div>'),e.put("app/components/cn-flex-form/forms/cn-autocomplete-detailed.html",'\n      <div sf-array="form"\n           class="form-group {{form.htmlClass}}"\n           ng-class="{\'has-error\': hasError(), \'has-success\': hasSuccess()}">\n        <label class="control-label"\n               for="{{form.key.join(\'.\')}}-input"\n               ng-show="showTitle()">{{form.title}}</label>\n        <ol class="list-group cn-autocomplete-list"\n            ng-show="modelArray.length"\n            ng-model="modelArray">\n          <li class="list-group-item {{form.fieldHtmlClass}}"\n              ng-repeat="item in modelArray track by $index">\n            <button ng-hide="form.readonly || form.remove === null"\n                    ng-click="deleteFromArray($index)"\n                    type="button" class="close pull-right">\n              <span aria-hidden="true">&times;</span>\n            </button>\n            <sf-decorator ng-init="arrayIndex = $index" form="copyWithIndex($index)"/>\n          </li>\n        </ol>\n        '+n+'\n        <span class="help-block" sf-message="form.description"></span>\n      </div>'),e.put("app/components/cn-flex-form/forms/cn-currency.html",'\n      <div class="form-group {{form.htmlClass}}"\n           ng-class="{\'has-error\': hasError(), \'has-success\': hasSuccess()}">\n        <label class="control-label"\n               ng-show="showTitle()"\n               for="{{form.key.join(\'.\')}}">{{form.title}}</label>\n        <div class="{{form.fieldClass}} input-group">\n          <label class="input-group-addon"\n                 ng-disabled="form.readonly"\n                 for="{{form.key.join(\'.\')}}">$</label>\n          <input class="form-control"\n                 cn-currency-format="{{form.currencyFormat}}"\n                 cn-currency-placeholder="{{form.placeholder}}"\n                 ng-show="form.key"\n                 ng-model-options="form.ngModelOptions"\n                 ng-disabled="form.readonly"\n                 sf-changed="form"\n                 schema-validate="form"\n                 type="text"\n                 step="any"\n                 min="{{form.min}}"\n                 max="{{form.max}}"\n                 id="{{form.key.join(\'.\')}}"\n                 name="{{form.key.join(\'.\')}}"\n                 ng-model="$$value$$">\n        </div>\n        <span class="help-block" sf-message="form.description"></span>\n      </div>'),e.put("app/components/cn-flex-form/forms/cn-radios.html",'<div class="form-group {{form.htmlClass}}"\n            ng-class="{\'has-error\': hasError(), \'has-success\': hasSuccess()}">\n         <label class="control-label" ng-show="showTitle()">{{form.title}}</label>\n         <div class="btn-group clearfix">\n           <label class="radio radio-block"\n                  ng-repeat="item in form.titleMap">\n             <input type="radio"\n                    sf-changed="form"\n                    ng-disabled="form.readonly"\n                    ng-model="$$value$$"\n                    ng-model-options="form.ngModelOptions"\n                    schema-validate="form"\n                    ff-validate="form"\n                    ng-value="item.value"\n                    name="{{form.key.join(\'.\')}}">\n             <span class="radio-block-icon" ng-if="item.iconClass">\n               <i class="fa fa-{{item.iconClass}} fa-lg"></i>\n             </span>\n             <span ng-bind-html="item.name"></span>\n           </label>\n         </div>\n         <span class="help-block" sf-message="form.description"></span>\n       </div>'),e.put("app/components/cn-flex-form/forms/cn-radiobuttons.html",'\n      <div class="form-group schema-form-radiobuttons cn-radiobuttons {{form.htmlClass}}"\n           ng-class="{\'has-error\': hasError(), \'has-success\': hasSuccess()}">\n        <label class="control-label" ng-show="showTitle()">{{form.title}}</label>\n        <div class="btn-group clearfix">\n          <label class="btn btn-{{item.value}} {{form.btnClass}} {{item.value === $$value$$ ? \'active\' : \'\'}}"\n                 ng-repeat="item in form.titleMap">\n            <input type="radio"\n                   class="{{form.fieldHtmlClass}} hide"\n                   sf-changed="form"\n                   ng-disabled="form.readonly"\n                   ng-model="$$value$$"\n                   ng-model-options="form.ngModelOptions"\n                   schema-validate="form"\n                   ff-validate="form"\n                   ng-value="item.value"\n                   name="{{form.key.join(\'.\')}}">\n            <i class="fa fa-{{item.value}} fa-lg"></i>\n            <span ng-bind-html="item.name"></span>\n          </label>\n        </div>\n        <span class="help-block" sf-message="form.description"></span>\n      </div>'),e.put("app/components/cn-flex-form/forms/cn-percentage.html",'\n      <div class="form-group {{form.htmlClass}}"\n           ng-class="{\'has-error\': hasError(), \'has-success\': hasSuccess()}">\n        <label class="control-label"\n               ng-show="showTitle()"\n               for="{{form.key && form.key[0]}}">{{form.title}}</label>\n        <div class="{{form.fieldClass}} input-group">\n          <input class="form-control"\n                 cn-percentage-format\n                 ng-show="form.key"\n                 ng-model-options="form.ngModelOptions"\n                 ng-disabled="form.readonly"\n                 sf-changed="form"\n                 schema-validate="form"\n                 type="number"\n                 step="any"\n                 min="{{form.min}}"\n                 max="{{form.max}}"\n                 id="{{form.key && form.key[0]}}"\n                 name="{{form.key && form.key[0]}}"\n                 ng-model="$$value$$">\n           <div class="input-group-addon"\n                  ng-disabled="form.readonly"\n                  for="{{form.key && form.key[0]}}">%</div>\n        </div>\n        <span class="help-block" sf-message="form.description"></span>\n      </div>'),e.put("app/components/cn-flex-form/forms/cn-display.html",'\n      <div class="form-group cn-display{{form.htmlClass}}">\n        <input ng-show="form.key"\n               class="form-control"\n               id="{{form.key.join(\'.\')}}"\n               name="{{form.key.join(\'.\')}}"\n               ng-disabled="true"\n               value="{{form.getDisplay(form.key, form.arrayIndex)}}">\n      </div>'),e.put("app/components/cn-flex-form/forms/cn-fieldset.html",'\n      <fieldset \n        ng-disabled="form.readonly"\n        class="schema-form-fieldset {{form.htmlClass}}"\n        ng-class="{\'borderless\': form.pos === 0}">\n        <legend ng-click="form.toggleCollapse(form)"\n                ng-class="{\'sr-only\': !showTitle(), collapsible: form.collapsible}"\n                ng-mouseenter="form.render = true">\n          <i ng-show="form.collapsible"\n             class="fa fa-caret-{{form.collapsed ? \'right\' : \'down\'}}"></i>\n          {{ form.title }}\n        </legend>\n        <div class="help-block" ng-show="form.description" ng-bind-html="form.description"></div>\n        <div uib-collapse="form.collapsed">\n          <div ng-if="form.render">\n            <sf-decorator ng-repeat="item in form.items" form="item"/>\n          </div>\n        </div>\n      </fieldset>'),e.put("app/components/cn-flex-form/forms/cn-mediaupload.html",'\n      <div class="form-group {{form.htmlClass}}"\n           ng-class="{\'has-error\': hasError(), \'has-success\': hasSuccess()}">\n        <label class="control-label"\n               ng-show="showTitle()"\n               for="{{form.key && form.key[0]}}">{{form.title}}</label>\n        <media-upload ng-model="$$value$$"\n                      cn-file-type="form.fileType"\n                      cn-upload-path="form.uploadPath"\n                      cn-data="form.data"\n                      cn-preview-path="form.previewPath"\n                      cn-model-value-key="form.modelValueKey"\n                      ng-model-options="form.ngModelOptions"\n                      sf-changed="form"\n                      schema-validate="form"\n                      ff-form="form"\n                      class="clearfix">\n        </media-upload>\n        <span class="help-block" sf-message="form.description"></span>\n     </div>'),e.put("app/components/cn-flex-form/forms/cn-csvupload.html",'\n      <div class="form-group {{form.htmlClass}}"\n           ng-class="{\'has-error\': hasError(), \'has-success\': hasSuccess()}">\n        <label class="control-label"\n               ng-show="showTitle()"\n               for="{{form.key && form.key[0]}}">{{form.title}}</label>\n        <csv-upload ng-model="$$value$$"\n                      cn-upload-path="form.uploadPath"\n                      ng-model-options="form.ngModelOptions"\n                      sf-changed="form"\n                      schema-validate="form"\n                      ff-form="form"\n                      class="clearfix">\n        </csv-upload>\n        <span class="help-block" sf-message="form.description"></span>\n     </div>'),e.put("app/components/cn-flex-form/forms/cn-reusable.html",'\n      <div class="form-group cn-reusable {{form.htmlClass}}"\n           ng-class="{\'has-error\': hasError(), \'has-success\': hasSuccess()}">\n        <label class="control-label"\n               ng-show="showTitle()"\n               for="{{form.key.join(\'.\')}}">{{form.title}}</label>\n        <cn-select-or\n          ng-show="form.key"\n          select-from="form.library"\n          ng-model="$$value$$"\n          ng-model-options="form.ngModelOptions"\n          sf-changed="form"\n          schema-validate="form"\n          ff-form="form"\n          directiveId="form.directiveId"\n          item-template="form.itemTemplate"\n          toggle-text="form.toggleText"\n          disabled="form.readonly"\n          view="form.view">\n          <sf-decorator ng-repeat="item in form.items" form="item"/>\n        </cn-select-or>\n        <p ng-if="form.loadMore && form.view === \'list\'">\n          <a ng-click="form.loadMore()"\n             class="btn btn-default btn-block">Load More</a>\n        </p>\n        <span class="help-block" sf-message="form.description"></span>\n      </div>'),e.put("app/components/cn-flex-form/forms/cn-table.html",'\n      <div class="form-group cn-ff-table {{form.htmlClass}}"\n           ng-class="{\'has-error\': hasError(), \'has-success\': hasSuccess()}">\n        <h6>{{form.title}}</h6>\n        <div class="row">\n          <div ng-repeat="col in form.columns" class="{{col.columnWidth}}">\n            <p class="column-header">{{col.columnHeader}}</p>\n          </div>\n        </div>\n        <div class="row" ng-repeat="row in form.items">\n          <div ng-repeat="col in row.items" class="{{col.columnWidth}}">\n            <sf-decorator form="col"></sf-decorator>\n          </div>\n        </div>\n        <span class="help-block" sf-message="form.description"></span>\n      </div>')}t.$inject=["cnFlexFormServiceProvider"],r.$inject=["$templateCache"],Object.defineProperty(n,"__esModule",{value:!0}),n.schemaFormConfig=t,n.addTemplates=r},function(e,n,t){"use strict";function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){"ngInject";function t(t){t.condition&&n.registerFieldType({condition:t.condition,type:t.type}),t.handler&&(l[t.type]=t.handler),t.templateUrl&&(e.addMapping("bootstrapDecorator",t.type,t.templateUrl),e.createDirective(t.type,t.templateUrl))}return{registerField:t,$get:a}}function a(e,n,t,o,a,f,m,u,p,h){"ngInject";function g(e,n,t){var r;if(Re.length)for(var o=0,a=Re.length;o<a;o++)if(Re[o].model===n){r=Re[o],r.compile(e,n,t);break}return r||(r=new v(e,n,t),Re.push(r)),r||new v(e,n,t)}function v(e,n,r){h.debug&&(window.services=Re),this.arrayCopies={},this.arrayListeners={},this.dataCache={},this.defaults={},this.errors=[],this.events=[],this.formCache={},this.scopeCache={},this.listeners={},this.resolveRegister={},this.model=n,this.updates=0,this.params=t.getStateParams(),this._=i,this.compile(e,n,r)}function y(e,n,t){var r=this;r.schema=e,r.model=n,r.isCompiled()||(r.setupConfig(t),e.forms?i.each(e.forms,function(e){i.each(e.form,r.processField.bind(r))}):i.each(e.form,r.processField.bind(r)),r.initModelWatch(),r.initArrayCopyWatch(),r.isCompiled(!0)),r.broadcastErrors()}function b(e){var n=this;return e&&(n.schema.compiled=e),n.schema&&n.schema.compiled}function x(e){var n=this;e&&(e.formCtrl&&(n.formCtrl=e.formCtrl),e.updateSchema&&(n.updateSchema=e.updateSchema),e.getSchema&&(n.getSchemaForm=n.setupSchemaRefresh(e.getSchema)))}function k(e){var n=e.schema;e.getSchemaType=function(){return i.isArray(n.type)?i.first(n.type):n.type},e.type||(e.type=e.getSchemaType&&e.getSchemaType())}function F(e){var n=this,t=e.schema,r=e.default||t.default,o=n.getKey(e.key);if(!n.updates&&e.updateSchema&&angular.isDefined(r)&&!n.schema.params[o]&&(n.schema.params[o]=r),n.updates||e.default){if(o.includes&&o.includes("[]"))return;var a=n.parseExpression(e.key,n.model),s=a.get();(i.isTrulyEmpty(s)||i.has(n.defaults,o)&&angular.equals(s,n.defaults[o]))&&a.set(r)}n.defaults[o]=angular.copy(r),"url"!==t.format||e.validationMessage||(e.type||(e.type="url"),e.validationMessage="Must be a valid url (https://...)")}function $(e){var n=this;e.type="cn-fieldset",e.items.forEach(n.processField.bind(n)),i.has(e,"pos")&&0===e.pos&&(e.htmlClass="borderless"),e.collapsible?(e.toggleCollapse=function(e){e.collapsible&&(e.collapsed=!e.collapsed)},e.render=!e.collapsed):e.render=!0}function w(e){var n=this,t=o.getFieldType(e),r=l[t];i.isString(r)?n[r](e):i.isFunction(r)&&r.call(n,e)}function C(e,n){var t=this;angular.isDefined(n)&&(e.pos=n),e._ogKeys||(e._ogKeys=i.without(i.keys(e),"key","htmlClass"));var r=t.getKey(e.key);if(r){t.addToFormCache(e,r);var o=t.getSchema(r);o&&(e.schema=o,o.description&&(e.description=o.description),e.readonly&&!o.readonly&&(e.readonly=!1),"array"!==o.type||"showClearAll"in e||(e.showClearAll=!0)),t.processSchema(e)}t.processFieldProps(e),r&&(i.find(t.errors,{key:r})&&(t.errors=i.reject(t.errors,{key:r}),m.$broadcast("schemaForm.error."+r,"schemaForm",!0),m.$broadcast("schemaForm.error."+r,"serverValidation",!0)),e.error&&(t.errors.push(t.buildError(e)),i.isEmpty(e.ngModelOptions)?e.ngModelOptions={allowInvalid:!0}:e.ngModelOptions.allowInvalid=!0))}function S(e){var n=this;d.forEach(function(t){var r=t.prop,o=t.handler;return i.has(e,r)&&o(e,n)})}function E(e){return i.isArray(e)&&(e=i.reduce(e,function(e,n){return/^(-?\d*)$/.test(n)?e+"["+n+"]":e+"."+n})),e}function T(e,n){var t=this;if(e){e=c.parse(t.getKey(e)),n=n||t.schema.schema.properties;for(var r=void 0,o=void 0;e.length>1;)r=e[0],o=e[1],/^-?\d*$/.test(o)?2===e.length?n=n=n[e.shift()]:(n=n[e.shift()].items.properties,e.shift()):n=n[e.shift()].properties;return r=e[0]||"items",n[r]}}function M(e){var n=this;return console.log(":: getDefault ::",e),e=e.key?e:n.getFromFormCache(e),console.log(":: getDefault ::",e),e&&(angular.isDefined(e.default)?e.default:e.schema&&e.schema.default)}function j(e){for(var n=[],t=re(e),r="";t;)/^-?\d+$/.test(t[1])?(r=t[0],e=e.replace(t[0],"ff_replace_ff")):(n.push(t[1].replace(/ff_replace_ff/g,r)),r="",e=e.replace(t[0],"")),t=re(e);return[].concat(n,[e.replace(/ff_replace_ff/g,r)])}function A(e){var n=this,t=n.getKey(e.key);return i.each(e.resolve,function(r,o){r=Ie(r,t),r.includes("[arrayIndex]")||(n.handleResolve(e,o,r),j(r).forEach(function(t){var a=t.match(/(schema\.data\.|model\.)(\S+)/)||[],i=s(a,3),c=i[1],l=i[2];c&&("schema.data."===c?n.registerResolve(e,o,l,r):"model."===c&&n.registerHandler(l,function(){n.handleResolve(e,o,r)}))}))}),e}function D(e,n,t){var r=this,o=r.parseExpression(t).get();if(!o&&0===t.indexOf("model.")){var a=t.replace("model.",""),s=r.getFromFormCache(a);o=s&&s.default?s.default:e.default||r.getSchema(a).default}o&&o.cursor?e.loadMore=function(){var e=t.match(/schema\.data\.(.+)/)[1];r.refreshSchema("data:"+e+":"+o.cursor)}:delete e.loadMore,e[n]=o&&o.data?o.data:o,d.forEach(function(t){var o=t.prop,a=t.handler;return o===n&&a(e,r)})}function P(e,n,t,r){var o=this,a=o.getKey(e.key);o.resolveRegister[t]=o.resolveRegister[t]||{};var s=o.resolveRegister[t];s[a]=s[a]||[],s[a].push({field:e,prop:n,exp:r})}function I(e){var n=this;i.each(e.conditionals,function(t,r){var o=function(o,a){e[r]=n.parseCondition(t);var s=n.getFromScopeCache(n.getKey(e.key));"required"===r&&s&&m.$broadcast("schemaFormValidate")};e.conditionals[r].match(/model\.([^\s]+)/g).map(function(e){return e.match(/model\.([^\s]+)/)[1]}).forEach(function(e){n.registerHandler(e,o)}),o()})}function _(e){var t=this;if(e.watch){var r=e.schema;e.watch=i.isArray(e.watch)?e.watch:[e.watch],i.each(e.watch,function(o){if(o.resolution){var a;!function(){var s=o.condition,c=o.resolution,l=void 0;i.isFunction(c)?l=function(e,n){s&&!t.parseCondition(s)||c(e,n)}:(a={},a.date=c.match(/\+ ?(\d+) days/),a.date?(a.date=a.date[1],c=c.replace(a.date,"").trim()):(a.math=c.match(/(\+|\-|\/|\*) ?(\S+)/),a.math&&(a.operator={"+":"add","-":"subtract","*":"multiply","/":"divide"}[a.math[1]],a.adjuster=t.parseExpression(a.math[2]))),c=c.match(/(\S+) ?= ?(\S+)/),l=function(o,l,d,f){var m=s&&Ie(s,d),u=Ie(c[1],d),p=Ie(c[2],d),h=t.parseExpression(u);if(f!==h.path().key){f=h.path().key;var g=t.parseExpression(p);if(!s||t.parseCondition(m))if(a.date)h.set(moment(g.get()).add(a.date,"days").toDate());else if(a.math){var v=n(g.get()+a.math[1]+a.adjuster.get())();if(r=r||e.items&&(e.items[0].schema||e.items[0].items&&e.items[0].items[0].schema),"cn-currency"===e.type){var y=r&&"currency-dollars"===r.format?2:0;v="*"===a.math[1]?i.floor(v,y):"/"===a.math[1]?i.ceil(v,y):i.round(v,y)}t.listeners[f]&&(t.listeners[f].trigger=d),h.set(v||0)}else h.set(g.get())}}),t.registerHandler(e,l,e.updateSchema,o.initialize)}()}})}}function O(e){var t=this;if(e.startsWith("_")){var r=/^_\.(.*?)\((.*?),[\s(]*(.*?)\)?\s*=>[{\s]*(?:return)?(.*?)\}?\)$/,o=e.match(r),a=s(o,5),c=a[1],l=a[2],d=a[3],f=a[4];return i[c](n(l)(t),K(d,f))}return n(e)(t)}function K(e,t){return function(){for(var r=arguments.length,o=Array(r),a=0;a<r;a++)o[a]=arguments[a];return n(t)(e.replace(/\s/g,"").split(",").reduce(function(e,n,t){return e[n]=o[t],e},{}))}}function R(e,n,t,r){var o=this;if(i.isObject(e)&&!i.isArray(e)){if(!e.key&&e.items)return void i.each(e.items,function(e){o.registerHandler(e,n,e.updateSchema)});e=e.key}e=o.getKey(e);var a=e.match(/([^[\]]*)\[]\.?(.*)/);if(a)return void o.registerArrayHandlers(a[1],a[2],n,t,r);var s=o.parseExpression(e,o.model).get(),c=i.get(o.getSchema(e),"default");if(!o.listeners[e]){var l=i.isUndefined(s)?angular.copy(c):angular.copy(s);o.listeners[e]={handlers:[],updateSchema:t,prev:l}}n&&(o.listeners[e].handlers.push(n),r&&n(s,null,e))}function H(e,n,t,r,o){var a=this,s=function(s,i,c){if(i||0===i||!((0|s)<1)){var l,d,f;if(i>s||c){var m=n?e+"["+(i-1)+"]."+n:e+"["+(i-1)+"]";if(a.listeners[m])for(l=0,d=i;l<d;l++)f=n?e+"["+l+"]."+n:e+"["+l+"]",a.deregisterHandlers(f);for(l=0,d=s;l<d;l++)f=n?e+"["+l+"]."+n:e+"["+l+"]",a.registerHandler(f,t,r)}else if(s>(i||0))for(l=0|i,d=s;l<d;l++)f=n?e+"["+l+"]."+n:e+"["+l+"]",a.registerHandler(f,t,r,o)}},c=a.parseExpression(e,a.model).get();i.each(c,function(s,i){var c=n?e+"["+i+"]."+n:e+"["+i+"]";a.registerHandler(c,t,r),o&&t(null,null,c)}),a.arrayListeners[e+".length"]?a.arrayListeners[e+".length"].handlers.push(s):a.arrayListeners[e+".length"]={handlers:[s],prev:c?c.length:0}}function U(e){var n=this;e=n.getKey(e);var t=e.match(/([^[\]]*)\[]\.?(.*)/);return t?void n.deregisterArrayHandlers(t[1],t[2]):void(n.listeners[e]&&(n.listeners[e].handlers=[]))}function q(e,n){var t=this;t.parseExpression(e,t.model).get().forEach(function(r,o){n?t.deregisterHandlers(e+"["+o+"]."+n):t.deregisterHandlers(e+"["+o+"]")})}function L(){var e=this;e.watching||(e.modelWatch&&e.modelWatch(),e.modelWatch=m.$watch(function(){return e.model},e.onModelWatch.bind(e),!0),e.initSchemaParams(),e.watching=!0,e.firstUpdate=!0)}function W(e,n){var t=this;!t.firstUpdate&&angular.equals(e,n)||(t.firstUpdate=!1,p.cleanModel(t.model),t.prevParams=angular.copy(t.params),i.each(t.arrayListeners,function(e,n){var r=t.parseExpression(n,t.model).get();angular.equals(r,e.prev)||(e.handlers.forEach(function(n){return n(r,e.prev)}),e.prev=angular.copy(r))}),i.each(t.listeners,function(e,n){e&&!function(){var r=t.parseExpression(n,t.model).get(),o=angular.equals(r,[])&&!e.prev;angular.equals(r,e.prev)||o||(e.handlers.forEach(function(t){t(r,e.prev,n,e.trigger)}),e.trigger=null,e.prev=angular.copy(r)),!e.updateSchema||angular.isUndefined(r)||o||null===r?delete t.params[n]:t.params[n]=r}()}),angular.equals(t.params,t.prevParams)||(t.model.id&&!t.updates&&i.isEmpty(t.prevParams)?++t.updates:t.refreshSchema()))}function V(){var e=this;i.each(e.listeners,function(n,t){if(n){var r=e.parseExpression(t,e.model).get();n.updateSchema&&!angular.isUndefined(r)&&null!==r&&(e.params[t]=r)}})}function N(){var e=this;e.events.push(m.$on("schemaFormPropagateScope",function(n,t){var r=t.form;r.key||(r.cacheKey=r.type+"-"+i.uniqueId());var o=r.cacheKey||e.getKey(r.key);if(t.arrayIndex){var a=o.replace(/\[\d+]/g,"[]"),s=t.arrayIndex;e.getArrayCopy(a,s)||e.processFieldProps(r),r.condition||(r.condition="true"),e.addArrayCopy(t,a,s),t.$emit("flexFormArrayCopyAdded",a)}else e.addToScopeCache(t,o)})),e.events.push(m.$on("schemaFormDeleteScope",function(n,t,r){var o=e.getKey(t.form.key),a=e.listeners[o];a&&(a.handlers=[]);var s=o.replace(/\[\d+]/g,"[]"),i=e.getArrayCopiesFor(s);if(i.forEach(function(e){return e.splice(r,1)}),t.form.link){var c=e.parseExpression(t.form.link,e.model).get();c.splice(r,1)}}))}function Q(e,n,t){var r=this;(!t||t<0)&&(t=0),r.arrayCopies[n]||(r.arrayCopies[n]=[]),r.arrayCopies[n][t]=e}function B(e,n){var t=this,r=t.arrayCopies[e];return r&&r[n]}function z(e){var n=this;return i.pluck(n.getArrayScopes(e),"form")}function G(e){var n=this;return e+="[]",i.filter(n.arrayCopies,function(n,t){return t.includes(e)})}function J(e){var n=this;return n.arrayCopies[e]}function X(e,n){var t=this;return t.scopeCache[n]&&console.warn("caching duplicate scope for",n),t.scopeCache[n]=e}function Y(e){var n=this;return n.scopeCache[e]}function Z(e,n){var t=this;n=n||t.getKey(e.key),t.getFromFormCache(n)||(t.formCache[n]=e)}function ee(e){var n=this;return n.formCache[e]}function ne(e,n){var t=this;e&&(t.dataCache[e]=n)}function te(e){var n=this;return n.dataCache[e]}function re(e){return e.match(/\[([^[\]]+)]([^[\]]*)/)}function oe(e,n){for(var t=this,r=re(e);r;)e=e.replace("["+r[1]+"]","."+t.parseExpression(r[1],n).get()),
r=re(e);return e}function ae(e,n){var t=this;if(!e||/^(null|false|true|undefined|'[^\']*'|"[^\"]*"|-?[0-9.]+|\[]|\{})$/.test(e))return{get:function(){if(!e)return e;var n=e.match(/"([^\"]*)"/)||e.match(/'([^\']*)'/);if(n)return n[1];switch(e){case"null":return null;case"false":return!1;case"true":return!0;case"undefined":return;case"[]":return[];case"{}":return{};default:return parseFloat(e)}}};e=t.getKey(e);var r=e.match(/^(model\.)?(\S+)$/),o={get:function(){for(var r=t.resolveNestedExpressions(e,n),o=c.parse(r),a=n||t;a&&o.length>1;)a=a[o.shift()];return a&&a[o[0]]},getAssignable:function(){for(var r=t.resolveNestedExpressions(e,n),o=c.parse(r),a=[],s=n||t;s&&o.length>1;){var i=o.shift();a.push(i),s[i]||(/^\d?$/.test(o[0])?s[i]=[]:s[i]={}),s=s[i]}return{obj:s,key:o[0],path:t.getKey(a),fullPath:t.getKey(a.concat(o.slice(0,1)))}},set:function(r){var o=t.resolveNestedExpressions(e,n),a=(c.parse(o),this.getAssignable());return"remove"===r?delete a.obj[a.key]:a.obj[a.key]=r,r},path:function(){return{exp:e,depth:n,key:r[2]}}};return o}function se(e){var n=this,t=n.getKey(e.key);e.sortOptions={update:function(e,r){var o=n.arrayListeners[t+".length"];o.handlers.forEach(function(e){e(o.prev,o.prev,!0)})}},n.processSection(e)}function ie(e){var n=this;i.each(e.items,n.processField.bind(n))}function ce(e){var n=this;e.type="section",e.htmlClass="row";var t=12/i.reject(e.items,"hidden").length;i.each(e.items,function(r,o){n.processField(r),e.items[o]={type:"section",htmlClass:"col-sm-"+t,items:[r]}})}function le(e){e.currencyFormat={"currency-dollars":"dollars","currency-microcents":"microcents",currency:"cents"}[e.schema.format],e.type="cn-currency"}function de(e){e.type="cn-percentage"}function fe(e){var n=this;e.type="cn-reusable",e.view=e.view||"new",e.items.forEach(n.processField.bind(n)),e.items=[{type:"section",items:e.items,condition:"!model."+n.getKey(e.key)+".id"}]}function me(e){var n=this;e.type="cn-mediaupload",i.each(e.data,function(t,r){e.data[r]=n.parseExpression(t).get()})}function ue(e){e.type="cn-csvupload"}function pe(e){e.type="cn-radios"}function he(e){e.type="cn-radiobuttons",e.fullWidth&&(e.btnClass="col-sm-"+i.divide(12,e.titleMap.length))}function ge(e){e.type="cn-datetimepicker","time-minutes"===e.schema.format&&(e.maxView="hour",e.iconClass="fa fa-clock-o",e.modelFormatter=function(e){if(e){var n=moment(e);return i.add(i.multiply(n.hours(),60),n.minutes())}},e.modelParser=function(e){if(e){var n=parseInt(e),t=i.floor(n/60),r=n%60;return moment().startOf("day").add("hours",t).add("minutes",r)}},e.viewFormatter=function(n){if(n)return e.modelParser(n).format(e.dateFormat)},e.viewParser=function(e){if(e){var n=e.match(/^(\d{1,2}):?(\d{1,2})? (a|p)/);if(n){var t=i.add("12"===n[1]?0:n[1],"a"===n[3]?0:12),r=n[2]||"00";return 1===r.length&&(r+="0"),i.add(i.multiply(t,60),r)}}})}function ve(e){var n="array"===e.getSchemaType();return e.valueProperty||"object"!==(n?e.schema.items.type:e.schema.type)&&"value"}function ye(e,n,t){t=t||e.getTitleMap();var o=ve(e);if(o){if("array"===e.getSchemaType()){if(!n||!i.isArray(n))return;var a=n.map(function(e){return i.find(t,r({},o,e))}).filter(function(e){return void 0!==e});return a}return i.find(t,r({},o,n))}}function be(n){var t=this,r=n.schema;if((n.titleMapResolve||n.titleMap)&&(n.getTitleMap=function(){return n.titleMap||t.schema.data[n.titleMapResolve]},n.onInit=function(e,r,o,a){var s=t.parseExpression(r.key,t.model);if("tag-init"===o){var i=ye(n,s.get());void 0!==i&&a(i)}}),n.titleMapQuery){var o=n.titleMapQuery.params.q;n.titleQuery=function(t){var r={};return o&&(r[o]=t),e.get({url:n.titleMapQuery.url,params:r})},o||(n.minLookup="0"),n.onInit=function(e,n,t,r){"tag-init"===t&&r(e)}}if(r.items){var a=[];i.each(r.items.properties,function(e,n){angular.isDefined(e.default)&&a.push({key:n,default:e.default})}),a.length&&(n.onAdd=function(e,n,t){e.value&&"tag-added"===t&&i.each(a,function(n){e.value[n.key]||(e.value[n.key]=n.default)})})}n.type.includes("cn-autocomplete")||(n.items?(n.detailedList=!0,"component"!==n.items[0].type&&(n.items.length>1&&(n.items=[{type:"component",items:n.items}]),t.processFieldset(n)),n.type="cn-autocomplete-detailed"):(n.selectionStyle||(n.selectionStyle="tags"===n.key?"tags":"array"===n.getSchemaType()&&1!==n.schema.maxItems?"list":"select"),n.type="cn-autocomplete"),n.titleMapResolve&&m.$on("cnFlexFormDiff:data",function(e,r){if(r[n.titleMapResolve]){var o=t.parseExpression(n.key,t.model),a=o.get();if(void 0!==a){var s=ye(n,a,r[n.titleMapResolve]);void 0===s&&o.set()}}})),n.displayFormat&&(n.itemFormatter=t.processTemplate(n.displayFormat)),t.registerHandler(n.key,function(e){var r=t.formCtrl&&t.formCtrl[t.getKey(n.key)];r&&r.$setDirty&&r.$setDirty()},n.updateSchema)}function xe(e){e.type="cn-toggle"}function ke(e){e.htmlClass="help-block"}function Fe(e){var n=this;e.type="cn-display",e.getDisplay=n.processTemplate(e.displayFormat,!0)}function $e(e,n){var t=this,r=f;return function(o,a){return n&&(angular.isDefined(a)&&(o=i.map(o,function(e){return"arrayIndex"===e?a:e})),o=t.parseExpression(o,t.model).get()),r(e)(o)}}function we(e){var n=this;e.type="cn-table",e.items.forEach(function(t){for(var r=0;r<e.columns.length;r++)i.extend(t.items[r],e.columns[r]),n.processField(t.items[r])})}function Ce(e){var n,t=this,r=t.getSchema(e.key),o=i.find(e.items,"selectField");n=r&&"array"===r.type?t.setupArraySelectDisplay(e,o):t.setupSelectDisplay(e,o),e.selectDisplay=!1,t.registerHandler(o.key,n,o.updateSchema,!0)}function Se(e,n){var t=this;i.each(e.items,function(e){"false"!==e.condition&&(e.condition="true")});var r=function(r,o,a){var s=_e(a);i.each(e.items,function(e){var r=t.getKey(n.key),o=t.getKey(e.key),a=c.parse(o);if(r!==o){var l=t.setArrayIndex(r,s),d=t.parseExpression(l,t.model).get(),f=t.getArrayCopies(o);i.includes(d,a[a.length-1])?i.each(f,function(e){_e(e)==s&&(e.condition="true")}):i.each(f,function(e){_e(e)==s&&(e.condition="false",t.parseExpression(t.getKey(e.key),t.model).set())})}})},o=t.parseExpression(t.getKey(e.key),t.model).get();i.each(e.items,function(e){var r=t.getKey(e.key),a=t.getKey(n.key);r!==a&&i.each(o,function(e,n){var o=t.setArrayIndex(r,n),s=c.parse(o),l=t.setArrayIndex(a,n),d=t.parseExpression(l,t.model),f=d.get(),m=t.parseExpression(o,t.model).get();m&&!i.includes(f,s[s.length-1])&&(f||(f=[]),f.push(s[s.length-1]),d.set(f))})});var a=t.getSchema(e.key).default;i.each(a,function(e,r){var o=t.getKey(n.key),a=t.setArrayIndex(o,r),s=t.parseExpression(a,t.model),c=s.get();i.each(e,function(e,n){c||(c=[]),c.push(n),s.set(c)})});var s=0,l=i.pluck(i.reject(e.items,{condition:"false"}),"key"),d=m.$on("flexFormArrayCopyAdded",function(n,o){var a=t.parseExpression(t.getKey(e.key),t.model).get();if(a){var c=a.length*l.length;if(i.includes(l,o)&&s++,s===c){for(var d=0;d<a.length;d++)r(null,null,"["+d+"]");s=0}}}),f=m.$on("flexForm.updatePage",function(){s=0});return t.events.push(d),t.events.push(f),r}function Ee(e,n){var t=this,r=function(){var r=t.getKey(n.key);i.each(e.items,function(e){var n=t.getKey(e.key),o=c.parse(n);if(r!==n){var a=t.parseExpression(r,t.model).get();i.includes(a,o[o.length-1])?e.condition="true":(e.condition="false",t.parseExpression(n,t.model).set())}})},o=t.getKey(n.key),a=t.parseExpression(o,t.model),s=a.get();i.each(e.items,function(e){var n=t.getKey(e.key);if(o!==n){var r=c.parse(n),l=t.parseExpression(n,t.model).get();l&&!i.includes(s,r[r.length-1])&&(s||(s=[]),s.push(r[r.length-1]),a.set(s))}});var l=t.getSchema(e.key).default;i.each(l,function(e,n){s||(s=[]),s.push(n),a.set(s)});var d=t.parseExpression(e.key,t.model);return l&&!d.get()&&d.set(l),r}function Te(e){var n=this;n.refreshSchema=i.debounce(function(r){var o,a=i.extend(t.getStateParams(),n.params),s=p.diff(n.schema.params,a,!0);(s||r)&&(r?a.updateSchema=r:(o=i.keys(s),o.length>1&&(s=i.omit(s,i.isNull),o=i.keys(s)),a.updateSchema=i.first(o)),a.updateSchema||(s=p.diff(a,i.omit(n.schema.params,"updateSchema")),o=i.keys(s),a.updateSchema=i.first(o)),e(a).then(function(e){++n.updates,n.processUpdatedSchema(e)}))},100),n.refreshData=i.debounce(function(){e(i.extend(n.schema.params,{updateSchema:"refreshData"})).then(function(e){n.processUpdatedSchema(e)})},100),n.events.push(m.$on("ffRefreshData",n.refreshData))}function Me(e){var n=this;if(e.diff){n.schema.params=e.params,e.diff.data&&(m.$broadcast("cnFlexFormDiff:data",e.diff.data),i.each(e.diff.data,function(e,t){e&&e.data&&!i.isEmpty(n.schema.data[t].data)&&!e.reset&&(e.data=n.schema.data[t].data.concat(e.data)),n.schema.data[t]=e,n.resolveRegister[t]&&i.each(n.resolveRegister[t],function(e){e.forEach(function(e){n.handleResolve(e.field,e.prop,e.exp)})})}));var t=[];e.diff.schema&&(m.$broadcast("cnFlexFormDiff:schema",e.diff.schema),i.each(e.diff.schema,function(e,r){n.schema.schema.properties[r]=e,Ae(e,r,t)})),e.diff.form&&(m.$broadcast("cnFlexFormDiff:form",e.diff.form),i.each(e.diff.form,function(e){t.indexOf(e.key)===-1&&t.push(e.key);var r=n.getFromFormCache(e.key);r&&n.reprocessField(r,e);var o=n.getArrayCopies(e.key);o&&o.forEach(function(t){return t&&n.reprocessField(t,e)})})),t.length&&i.each(t,function(e){var t=n.getFromFormCache(e);if(t&&n.processField(t),e.includes("[]")){var r=n.getArrayCopies(e);i.each(r,function(e){e&&n.processField(e)})}}),n.broadcastErrors()}else n.updateSchema(e)}function je(e,n,t){var r=this;!n.condition&&e.condition&&(n.condition="true");var o=!t&&e.condition!==n.condition;i.extend(e,i.omit(n,"items","key")),e._ogKeys.forEach(function(t){n[t]||delete e[t]}),e._ogKeys=i.keys(n),r.deregisterHandlers(n.key),m.$broadcast("cnFlexFormReprocessField",n.key),o&&e.redraw&&(console.log("TODO: see if this can be removed"),e.redraw())}function Ae(e,n,t){t.push(n),e.properties&&i.each(e.properties,function(e,r){Ae(e,n+"."+r,t)}),e.items&&e.items.properties&&i.each(e.properties,function(e,r){Ae(e,n+"[]."+r,t)})}function De(e){var n=this,t=n.getKey(e.key);return{key:t,message:e.error}}function Pe(){var e=this;u(function(){e.errors.forEach(function(e){m.$broadcast("schemaForm.error."+e.key,"serverValidation",e.message)})},1)}function Ie(e,n){if(!e.includes("arrayIndex"))return e;var t=/([^.[]*)\[arrayIndex\]/.exec(e),r=new RegExp(t[1]+"\\[(-?\\d+)\\]"),o=r.exec(n);return o?e.replace(new RegExp(t[0].replace(/(\[|\])/g,"\\$1"),"g"),o[0]):e}function _e(e){return i.isObject(e)?i.find(e.key,function(e){return i.isNumber(e)}):/\[(\d+)\]/.exec(e)[1]}function Oe(e,n,t){var r,o=this;r=i.isString(e)?c.parse(e):i.clone(e);var a=r.indexOf("");return r[a]=n,t?r:o.getKey(r)}function Ke(){var e=this;i.each(e.events,function(e){e()})}var Re=[],He={compile:y,addArrayCopy:Q,addToDataCache:ne,addToFormCache:Z,addToScopeCache:X,broadcastErrors:Pe,buildError:De,cleanup:Ke,deregisterHandlers:U,deregisterArrayHandlers:q,getArrayCopy:B,getArrayCopies:z,getArrayCopiesFor:G,getArrayScopes:J,getDefault:M,getFromDataCache:te,getFromFormCache:ee,getFromScopeCache:Y,getKey:E,getSchema:T,getWatchables:j,handleResolve:D,initArrayCopyWatch:N,initModelWatch:L,initSchemaParams:V,isCompiled:b,onModelWatch:W,parseCondition:O,parseExpression:ae,processArray:se,processDefault:F,processDisplay:Fe,processField:C,processFieldset:$,processFieldProps:S,processFieldType:w,processFieldWatch:_,processComponent:ce,processConditional:I,processCurrency:le,processPercentage:de,processDate:ge,processHelp:ke,processRadios:pe,processRadiobuttons:he,processReusable:fe,processSchema:k,processSelectDisplay:Ce,processResolve:A,processSection:ie,processSelect:be,processTable:we,processTemplate:$e,processToggle:xe,processUpdatedSchema:Me,processMediaUpload:me,processCsvUpload:ue,registerArrayHandlers:H,registerHandler:R,registerResolve:P,replaceArrayIndex:Ie,reprocessField:je,resolveNestedExpressions:oe,setArrayIndex:Oe,setupConfig:x,setupArraySelectDisplay:Se,setupSelectDisplay:Ee,setupSchemaRefresh:Te};return i.extend(v.prototype,He),i.extend(g,He),g}o.$inject=["schemaFormDecoratorsProvider","cnFlexFormTypesProvider"],a.$inject=["Api","$parse","cnFlexFormConfig","cnFlexFormTypes","sfPath","$interpolate","$rootScope","$timeout","cnUtil","$stateParams"],Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function e(e,n){var t=[],r=!0,o=!1,a=void 0;try{for(var s,i=e[Symbol.iterator]();!(r=(s=i.next()).done)&&(t.push(s.value),!n||t.length!==n);r=!0);}catch(e){o=!0,a=e}finally{try{!r&&i.return&&i.return()}finally{if(o)throw a}}return t}return function(n,t){if(Array.isArray(n))return n;if(Symbol.iterator in Object(n))return e(n,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i="undefined"!=typeof window&&window._||t(6),c="undefined"!=typeof window&&window.ObjectPath||t(7),l={fieldset:"processFieldset","cn-radios":"processRadios","cn-radiobuttons":"processRadiobuttons","cn-autocomplete":"processSelect","cn-datetimepicker":"processDate",help:"processHelp","cn-display":"processDisplay","cn-currency":"processCurrency","cn-percentage":"processPercentage","cn-mediaupload":"processMediaUpload","cn-csvupload":"processCsvUpload","cn-reusable":"processReusable","cn-toggle":"processToggle","cn-table":"processTable",component:"processComponent",section:"processSection",tabarray:"processSection",array:"processArray"},d=[{prop:"selectDisplay",handler:function(e,n){return n.processSelectDisplay(e)}},{prop:"resolve",handler:function(e,n){return n.processResolve(e)}},{prop:"watch",handler:function(e,n){return e.watch&&n.processFieldWatch(e)}},{prop:"type",handler:function(e,n){return n.processFieldType(e)}},{prop:"conditionals",handler:function(e,n){return n.processConditional(e)}},{prop:"default",handler:function(e,n){return n.processDefault(e)}},{prop:"schema",handler:function(e,n){return i.isUndefined(e.default)&&!i.isUndefined(e.schema.default)&&n.processDefault(e)}},{prop:"updateSchema",handler:function(e,n){return n.registerHandler(e,null,e.updateSchema)}}];n.default=o},function(n,t){n.exports=e},function(e,t){e.exports=n},function(e,n){"use strict";function t(e){if(i[e])return i[e];var n={};return i[e]=n,n}function r(e,n,r){var o=t(e);if(o[n])return o[n];var a=r.defer();return o[n]=a,a}function o(){function e(e,t){t.resolve={parent:n},s[e]=t}function n(e,n){"ngInject";return r(e.modal,e.modalId,n).promise.then(function(e){var n=e.parent;return n})}return n.$inject=["$stateParams","$q"],{addMapping:e,$get:a}}function a(e,n){"ngInject";function t(e,t,o){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=a.scope;i&&(i.options=i.options||{},i.options.destroyStrategy="retain",s[e].scope=i);var c=r(e,t,n);return c.resolve({parent:o,options:a}),c.promise}function o(t){var o=n.defer();return r(e.modal,e.modalId,n).promise.then(function(e){var n=e.parent,r=e.options;return o.resolve({state:s[t],options:r}),n}),o.promise}return{getMapping:o,resolveMapping:t}}a.$inject=["$stateParams","$q"],Object.defineProperty(n,"__esModule",{value:!0});var s={},i={};n.default=o},function(e,n){"use strict";function t(e,n,t,r){"ngInject";function o(){e.open(i).then(function(e){var n=e.modal,o=e.options,c=o.onDismiss;o.onAfterDismiss;i.modal=n,i.modal.result.finally(a),c&&i.modal.result.catch(function(){return c(r.restParams)}),i.dismissEvent=t.$on("$stateChangeStart",s)})}function a(){n.transition||n.go("^")}function s(){console.log("dismissModal"),i.dismissEvent(),i.modal.dismiss()}var i=this;o()}function r(e,n,t){"ngInject";function r(){return e.getMapping(t.modal).then(function(e){var t=e.state,r=e.options;return{modal:n.open(t),options:r}})}return{open:r}}t.$inject=["FlexFormModal","$state","$rootScope","$stateParams"],r.$inject=["cnFlexFormModalLoaderService","$uibModal","$stateParams"],Object.defineProperty(n,"__esModule",{value:!0}),n.FlexFormModalLoader=t,n.FlexFormModal=r},function(e,n,t){(function(e){"use strict";function t(){return{restrict:"E",template:'\n      <div ng-if="vm.showForm()">\n        <ng-form \n          class="clearfix"\n          name="{{vm.formName}}"\n          sf-schema="vm.config.schema.schema"\n          sf-form="vm.form"\n          sf-model="vm.model"/>\n        <!-- debug panel to display model -->\n        <section ng-if="vm.debug">\n          <json-explorer json-data="vm.model || \'...model not loaded yet\'"/>\n        </section>\n      </div>\n    ',scope:{config:"=ffConfig",model:"=ffModel",formIndex:"=ffFormIndex",formName:"=ffFormName",delayForm:"=ffDelayForm",cleanupEvent:"=ffCleanupEvent"},controller:r,controllerAs:"vm",bindToController:!0}}function r(e,n,t){"ngInject";function r(){angular.isNumber(c.formIndex)?c.form=c.config.schema.forms[c.formIndex].form:c.form=c.config.schema.form,t.search().debug&&(c.debug=!0)}function o(n,t){c.form&&(c.service?(console.log("vm.service.isCompiled():",c.service.isCompiled()),c.service.compile(c.config.schema,c.model)):c.service=e(c.config.schema,c.model,{formCtrl:c.config.formCtrl,getSchema:c.config.getSchema,updateSchema:s}))}function a(){return!c.delayForm&&c.service&&c.service.isCompiled()}function s(e){c.config.schema=e,c.activate()}function i(){_.each(c.events,function(e){e()}),c.service.cleanup()}var c=this;c.service=void 0,c.events=[],c.activate=r,c.cleanup=i,c.process=o,c.showForm=a,c.events.push(n.$watch(function(){return c.config.schema},c.process)),c.activate(),n.$on(c.cleanupEvent||"$destroy",c.cleanup)}r.$inject=["cnFlexFormService","$scope","$location"],Object.defineProperty(n,"__esModule",{value:!0}),n.default=t}).call(n,t(11))},function(e,n){function t(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function o(e){if(d===setTimeout)return setTimeout(e,0);if((d===t||!d)&&setTimeout)return d=setTimeout,setTimeout(e,0);try{return d(e,0)}catch(n){try{return d.call(null,e,0)}catch(n){return d.call(this,e,0)}}}function a(e){if(f===clearTimeout)return clearTimeout(e);if((f===r||!f)&&clearTimeout)return f=clearTimeout,clearTimeout(e);try{return f(e)}catch(n){try{return f.call(null,e)}catch(n){return f.call(this,e)}}}function s(){h&&u&&(h=!1,u.length?p=u.concat(p):g=-1,p.length&&i())}function i(){if(!h){var e=o(s);h=!0;for(var n=p.length;n;){for(u=p,p=[];++g<n;)u&&u[g].run();g=-1,n=p.length}u=null,h=!1,a(e)}}function c(e,n){this.fun=e,this.array=n}function l(){}var d,f,m=e.exports={};!function(){try{d="function"==typeof setTimeout?setTimeout:t}catch(e){d=t}try{f="function"==typeof clearTimeout?clearTimeout:r}catch(e){f=r}}();var u,p=[],h=!1,g=-1;m.nextTick=function(e){var n=new Array(arguments.length-1);if(arguments.length>1)for(var t=1;t<arguments.length;t++)n[t-1]=arguments[t];p.push(new c(e,n)),1!==p.length||h||o(i)},c.prototype.run=function(){this.fun.apply(null,this.array)},m.title="browser",m.browser=!0,m.env={},m.argv=[],m.version="",m.versions={},m.on=l,m.addListener=l,m.once=l,m.off=l,m.removeListener=l,m.removeAllListeners=l,m.emit=l,m.binding=function(e){throw new Error("process.binding is not supported")},m.cwd=function(){return"/"},m.chdir=function(e){throw new Error("process.chdir is not supported")},m.umask=function(){return 0}},function(e,n){"use strict";function t(){return{restrict:"E",scope:{config:"=ffHeaderConfig",submit:"&ffSubmit",loadOffscreen:"&ffLoadOffscreen"},controller:r,bindToController:!0,controllerAs:"vm",template:'\n        <div class="col-md-6">\n          <h5 ng-if="vm.title.lead">{{::vm.title.lead}}</h5>\n          <h1>\n            <i ng-show="vm.title.icon" class="{{vm.title.icon}}"/>\n            {{vm.title.main}}\n          </h1>\n          <h5 ng-if="vm.title.sub">{{::vm.title.sub}}</h5>\n        </div>\n        <div class="{{vm.buttonContainerClass || \'page-action-btns\'}}">\n          <div class="btn-options"\n               ng-mouseover="vm.loadOffscreen()">\n            <a class="btn btn-{{vm.returnStyle ? vm.returnStyle : \'default-dark\'"\n               ng-if="vm.returnState"\n               ui-sref="{{vm.returnState}}">\n              {{vm.returnText || \'Cancel\'}}\n            </a>\n            <a class="btn btn-{{vm.closeButton.style ? vm.closeButton.style : \'default-dark\'}}"\n               ng-if="vm.closeButton"\n               ng-click="vm.closeButton.handler()">\n               Cancel\n            </a>\n            <span ng-repeat="button in vm.actions">\n              <span ng-class="{\'btn-group\': button.options}">\n                <a class="btn {{button.style ? \'btn-\'+button.style : ($index === vm.actions.length - 1 ? \'btn-primary\' : \'btn-default-dark\')}}"\n                   ng-disabled="vm.isDisabled(button)"\n                   ng-click="vm.submit({handler: button.handler})"\n                   uib-tooltip="{{button.helptext}}"\n                   uib-tooltip-placement="bottom"\n                   ng-bind-html="button.text || \'Save\'">\n                </a>\n                <a class="btn {{button.style ? \'btn-\'+button.style : ($index === vm.actions.length - 1 ? \'btn-primary\' : \'btn-default-dark\')}} dropdown-toggle"\n                        ng-disabled="vm.isDisabled(button)"\n                        ng-show="button.options"\n                        data-toggle="dropdown">\n                  <span class="caret"></span>\n                </a>\n                <ul class="dropdown-menu" ng-if="button.options">\n                  <li ng-repeat="option in button.options"\n                      ng-disabled="vm.isDisabled(option)">\n                    <a ng-click="vm.submit({handler: option.handler})"\n                       ng-bind-html="option.text">\n                    </a>\n                  </li>\n                </ul>\n              </span>\n            </span>\n          </div>\n          <p class="data-updated-at text-right"\n             id="data-updated-at"\n             ng-hide="vm.config.noData">\n            <a ng-click="vm.updateData()">Update Data</a>\n          </p>\n        </div>'}}function r(e){"ngInject";function n(){o.title=o.config.title;var e=o.config.actionConfig;o.returnState=e.returnState,o.returnStyle=e.returnStyle,o.returnText=e.returnText,o.closeButton=e.closeButton,o.actions=e.actions}function t(){console.log("updateData:",t),e.$emit("ffRefreshData")}function r(e){return!!o.config.isDisabled&&o.config.isDisabled(e)}var o=this;o.updateData=t,o.isDisabled=r,n()}r.$inject=["$scope"],Object.defineProperty(n,"__esModule",{value:!0}),n.default=t},function(e,n){"use strict";function t(){return{restrict:"A",scope:{form:"=ffValidate"},require:"ngModel",link:r}}function r(e,n,t,r){e.form&&e.form.required&&e.$watch(function(){return r.$viewValue},function(e){r.$setValidity("schemaForm",!0),r.$setValidity("tv4-302",e)})}Object.defineProperty(n,"__esModule",{value:!0}),n.default=t}])});
//# sourceMappingURL=all.min.js.map